let p f x = let rec o = f x o in o

let atomic fun f g x = g (x + 1)

let atomic fun g x = x + 2, 3

(*
let node g(h)(t)(x, y) =
  let rec o1, o2 = run h (x, o3)
  and o3, o4 = run t (o1, o2) in
  o1 + y, o4

let node f(x) = 0 fby x + 1
let node l(x) = let rec r = f(0 fby x+1) in r
let node h(x) = let rec o = l(o+1) in o
  
let node h1 (x,y) = (x, y)
let node h2 (x,y) = (x, y)

let node gg(x, y) = g(h1)(h2)(x,y)

let node ff(x) = 0 fby x + 1
let node l2(x) = let rec o = ff(o+1) in o+1
 *)
